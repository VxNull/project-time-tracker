<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理项目</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-4">管理项目</h1>
        
        <form action="/admin/project" method="POST" class="mb-8">
            <input type="hidden" name="action" value="add">
            <div class="flex items-center space-x-2">
                <input type="text" name="name" placeholder="项目名称" required class="border p-2 rounded">
                <input type="text" name="code" placeholder="项目代码" required class="border p-2 rounded">
                <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">添加项目</button>
            </div>
        </form>

        <table class="w-full bg-white shadow-md rounded">
            <thead>
                <tr class="bg-gray-200">
                    <th class="p-2 text-left">ID</th>
                    <th class="p-2 text-left">名称</th>
                    <th class="p-2 text-left">代码</th>
                    <th class="p-2 text-left">操作</th>
                </tr>
            </thead>
            <tbody>
                {{range .}}
                <tr>
                    <td class="p-2">{{.ID}}</td>
                    <td class="p-2">{{.Name}}</td>
                    <td class="p-2">{{.Code}}</td>
                    <td class="p-2">
                        <button onclick="editProject('{{.ID}}', '{{.Name}}', '{{.Code}}')" class="bg-yellow-500 text-white px-2 py-1 rounded mr-2">编辑</button>
                        <form action="/admin/project" method="POST" class="inline">
                            <input type="hidden" name="action" value="delete">
                            <input type="hidden" name="id" value="{{.ID}}">
                            <button type="submit" class="bg-red-500 text-white px-2 py-1 rounded" onclick="return confirm('确定要删除这个项目吗？')">删除</button>
                        </form>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>

    <script>
    function editProject(id, name, code) {
        const newName = prompt("输入新的项目名称:", name);
        const newCode = prompt("输入新的项目代码:", code);
        if (newName && newCode) {
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '/admin/project';
            form.innerHTML = `
                <input type="hidden" name="action" value="edit">
                <input type="hidden" name="id" value="${id}">
                <input type="hidden" name="name" value="${newName}">
                <input type="hidden" name="code" value="${newCode}">
            `;
            document.body.appendChild(form);
            form.submit();
        }
    }
    </script>
</body>
</html>

